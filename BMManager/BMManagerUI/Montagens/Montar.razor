@page "/montagens/montar/{_codMontagem:int}"
@rendermode InteractiveServer
@using BMManagerLN
@using BMManagerLN.SubMontagens
@using BMManagerLN.SubMoveis
@inject APIBMManagerLN ln
@inject NavigationManager NavigationManager
@inject AuthenticationStateProvider asp
@attribute [Authorize(Roles = "Administracao,Montagem")]


<div class="MontagemDeEtapa">
    @if (_etapa == null || _montagem == null)
    {
        <p>A carregar etapa ...</p>
    }
    else
    {
        <div class="Etapa">
            <div class="ImagemEtapaMontagem">
                <EtapaMontagem Etapa="@_etapa" />
            </div>
            <div class="Botoes">
                <Botao Nome="Sair" Url="montagens" /> <!-- Alterar para confirmação -->
                <Botao Nome="Terminar Etapa" />
            </div>
        </div>
    }
</div>


@code {
    [Parameter]
    public int _codMontagem { get; set; }
    private Montagem? _montagem;
    private Etapa? _etapa;

    protected override async Task OnInitializedAsync()
    {
        _montagem = await ln.GetMontagem(_codMontagem);
        _etapa = await ln.GetEtapa(_montagem.Etapa);
    }
}
